CREATE TABLE IF NOT EXISTS permissions (permission VARCHAR(10) PRIMARY KEY);
INSERT INTO permissions(permission) VALUES ('doctor');
INSERT INTO permissions(permission) VALUES ('fireman');


CREATE TABLE IF NOT EXISTS users (user_id INTEGER PRIMARY KEY AUTOINCREMENT, email TEXT NOT NULL UNIQUE, salt VARCHAR(16) NOT NULL, rol VARCHAR(10) NOT NULL, FOREIGN KEY(rol) REFERENCES permissions(permission));

INSERT INTO users (email, rol) VALUES ('test0@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test1@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('test2@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test3@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('test4@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test5@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('silvia@mail.com', 'doctor');

CREATE TABLE IF NOT EXISTS devices (device_id VARCHAR(36) PRIMARY KEY, permission VARCHAR(10) NOT NULL, FOREIGN KEY(permission) REFERENCES permissions(permission));
INSERT INTO devices(device_id, permission) VALUES ('d52a56b9-fb4c-4cc6-b34c-3aec6f913b31', 'fireman');



CREATE TABLE IF NOT EXISTS device_permissions(id INTEGER PRIMARY KEY AUTOINCREMENT, device_id VARCHAR(36) NOT NULL, permission VARCHAR(10) NOT NULL, FOREIGN KEY(device_id) REFERENCES device(device_id), FOREIGN KEY(permission) REFERENCES permissions(permission));

CREATE TABLE IF NOT EXISTS emergency (emergency_id INTEGER PRIMARY KEY AUTOINCREMENT, severity INTEGER NOT NULL, coords VARCHAR(25) NOT NULL, address VARCHAR(50) NOT NULL, description VARCHAR(512), permission VARCHAR(10) NOT NULL, FOREIGN KEY(permission) REFERENCES permissions(permission));
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.718035, 41.228000', 'Ronda Ibèrica 161, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus sapien ac odio ornare pellentesque eget ut enim. Etiam commodo sem eget neque accumsan ullamcorper. Proin mattis sapien tellus, quis facilisis sem fermentum a. Nullam malesuada sem in neque eleifend consequat. Sed quis justo dictum, tristique felis non, porta tortor. Quisque volutpat interdum urna, id consectetur erat rutrum vel. Curabitur aliquet velit eget sapien porttitor cursus. Proin porta, lorem finibus cursus varius, sem velit convallis velit, aliquam laoreet ex nunc ac eros. Vestibulum ac libero sit amet libero tincidunt porttitor. In sed eleifend orci, eget feugiat est. Ut congue mauris magna, vitae accumsan neque suscipit quis. Maecenas ac ipsum arcu. Nunc enim ante, convallis quis erat nec, elementum porta nunc. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.7238606, 41.2214424','Rambla De Salvador Samà 49, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Donec eget cursus nunc, sed posuere sapien. Praesent varius ac leo sed ullamcorper. Sed accumsan placerat augue, id accumsan nunc suscipit auctor. Quisque vitae leo libero. Vivamus mattis quis ante et ullamcorper. Sed tempor molestie feugiat. Pellentesque lobortis purus a consequat iaculis. Aenean mattis commodo diam id finibus. Curabitur pharetra libero lorem, at mollis felis pharetra accumsan. Phasellus sodales mi sed sagittis fermentum. In a massa orci. Donec eget magna id mauris laoreet fringilla vel in ligula. Nunc iaculis, lacus vitae efficitur tristique, mauris sapien vulputate orci, commodo volutpat nisl tortor eget nulla. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (2, '1.7240076, 41.22431', 'Carrer Del Recreo 5, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Aenean quis fringilla elit. Sed sit amet lorem vitae orci accumsan mattis eget non massa. Nunc ipsum ligula, consectetur quis imperdiet ac, ullamcorper ac elit. Suspendisse sagittis ultrices tellus et tristique. Curabitur augue quam, iaculis at lorem id, laoreet sagittis elit. Phasellus consequat metus mauris, in faucibus lorem ornare non. Quisque elementum, justo a viverra vehicula, neque metus feugiat ante, at viverra nunc lacus ut odio. Nullam ultrices maximus porttitor. Aenean hendrerit orci id ultricies aliquet. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (1, '1.7260156,41.227707', 'Plaça Llarga 24, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Vivamus fringilla porta turpis nec facilisis. Pellentesque lobortis quam ut turpis egestas, id dictum sem efficitur. Suspendisse scelerisque porttitor urna at fermentum. Curabitur consequat, lacus sit amet ultricies vehicula, libero erat pharetra libero, a facilisis arcu felis in eros. Duis facilisis cursus massa ac auctor. Duis eu convallis nibh, sit amet ornare urna. Curabitur sagittis dui massa, nec fermentum augue euismod vel. Ut venenatis lacus sed malesuada convallis. In tempus, turpis ut suscipit tincidunt, tellus diam tincidunt diam, eget facilisis orci diam a diam. Ut nec metus nunc. Proin ultrices sagittis orci vitae sagittis. Sed sed mauris vehicula, ultrices leo a, dictum felis. Fusce convallis pulvinar sem eget lacinia. Proin sit amet nibh mi.', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (1, '1.7204153,41.226827', 'Carrer De Tarragona 5, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Vivamus at scelerisque est, ac facilisis eros. Nam mollis mi eu fermentum tempor. Duis massa elit, laoreet et mattis vel, auctor ac nibh. Duis a erat auctor, pretium sem gravida, tempus mi. Ut est erat, luctus sed nisi a, consectetur efficitur nunc. Duis ut nunc elementum, feugiat est eget, tincidunt velit. Suspendisse in dapibus justo. Sed imperdiet eu metus vitae hendrerit. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed sit amet sodales felis, vel viverra dui. Ut interdum quam felis, quis condimentum turpis tempor sollicitudin. Nam ac placerat massa. Nunc placerat sem ultrices neque dictum, sed bibendum libero scelerisque. Aliquam tincidunt orci elementum ipsum sagittis pretium. Praesent arcu felis, interdum vitae interdum quis, consequat eu tortor. ', 'doctor' );



CREATE TABLE IF NOT EXISTS permissions (permission VARCHAR(10) PRIMARY KEY);
INSERT INTO permissions(permission) VALUES ('doctor');
INSERT INTO permissions(permission) VALUES ('fireman');


CREATE TABLE IF NOT EXISTS users (user_id SERIAL PRIMARY KEY, email TEXT NOT NULL UNIQUE, salt VARCHAR(16) NOT NULL, rol VARCHAR(10) NOT NULL, FOREIGN KEY(rol) REFERENCES permissions(permission));

INSERT INTO users (email, rol) VALUES ('test0@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test1@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('test2@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test3@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('test4@mail.com', 'doctor');
INSERT INTO users (email, rol) VALUES ('test5@mail.com', 'fireman');
INSERT INTO users (email, rol) VALUES ('silvia@mail.com', 'doctor');

CREATE TABLE IF NOT EXISTS devices (device_id VARCHAR(36) PRIMARY KEY, permission VARCHAR(10) NOT NULL, FOREIGN KEY(permission) REFERENCES permissions(permission));
INSERT INTO devices(device_id, permission) VALUES ('d52a56b9-fb4c-4cc6-b34c-3aec6f913b31', 'fireman');

CREATE TABLE IF NOT EXISTS device_permissions(id SERIAL PRIMARY KEY, device_id VARCHAR(36) NOT NULL, permission VARCHAR(10) NOT NULL, FOREIGN KEY(device_id) REFERENCES device(device_id), FOREIGN KEY(permission) REFERENCES permissions(permission));

CREATE TABLE IF NOT EXISTS emergency (emergency_id SERIAL PRIMARY KEY, severity INTEGER NOT NULL, coords VARCHAR(25) NOT NULL, address TEXT NOT NULL, description TEXT, permission VARCHAR(10) NOT NULL, FOREIGN KEY(permission) REFERENCES permissions(permission));
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.718035, 41.228000', 'Ronda Ibèrica 161, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus sapien ac odio ornare pellentesque eget ut enim. Etiam commodo sem eget neque accumsan ullamcorper. Proin mattis sapien tellus, quis facilisis sem fermentum a. Nullam malesuada sem in neque eleifend consequat. Sed quis justo dictum, tristique felis non, porta tortor. Quisque volutpat interdum urna, id consectetur erat rutrum vel. Curabitur aliquet velit eget sapien porttitor cursus. Proin porta, lorem finibus cursus varius, sem velit convallis velit, aliquam laoreet ex nunc ac eros. Vestibulum ac libero sit amet libero tincidunt porttitor. In sed eleifend orci, eget feugiat est. Ut congue mauris magna, vitae accumsan neque suscipit quis. Maecenas ac ipsum arcu. Nunc enim ante, convallis quis erat nec, elementum porta nunc. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.7238606, 41.2214424','Rambla De Salvador Samà 49, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Donec eget cursus nunc, sed posuere sapien. Praesent varius ac leo sed ullamcorper. Sed accumsan placerat augue, id accumsan nunc suscipit auctor. Quisque vitae leo libero. Vivamus mattis quis ante et ullamcorper. Sed tempor molestie feugiat. Pellentesque lobortis purus a consequat iaculis. Aenean mattis commodo diam id finibus. Curabitur pharetra libero lorem, at mollis felis pharetra accumsan. Phasellus sodales mi sed sagittis fermentum. In a massa orci. Donec eget magna id mauris laoreet fringilla vel in ligula. Nunc iaculis, lacus vitae efficitur tristique, mauris sapien vulputate orci, commodo volutpat nisl tortor eget nulla. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (2, '1.7240076, 41.22431', 'Carrer Del Recreo 5, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Aenean quis fringilla elit. Sed sit amet lorem vitae orci accumsan mattis eget non massa. Nunc ipsum ligula, consectetur quis imperdiet ac, ullamcorper ac elit. Suspendisse sagittis ultrices tellus et tristique. Curabitur augue quam, iaculis at lorem id, laoreet sagittis elit. Phasellus consequat metus mauris, in faucibus lorem ornare non. Quisque elementum, justo a viverra vehicula, neque metus feugiat ante, at viverra nunc lacus ut odio. Nullam ultrices maximus porttitor. Aenean hendrerit orci id ultricies aliquet. ', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (1, '1.7260156,41.227707', 'Plaça Llarga 24, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Vivamus fringilla porta turpis nec facilisis. Pellentesque lobortis quam ut turpis egestas, id dictum sem efficitur. Suspendisse scelerisque porttitor urna at fermentum. Curabitur consequat, lacus sit amet ultricies vehicula, libero erat pharetra libero, a facilisis arcu felis in eros. Duis facilisis cursus massa ac auctor. Duis eu convallis nibh, sit amet ornare urna. Curabitur sagittis dui massa, nec fermentum augue euismod vel. Ut venenatis lacus sed malesuada convallis. In tempus, turpis ut suscipit tincidunt, tellus diam tincidunt diam, eget facilisis orci diam a diam. Ut nec metus nunc. Proin ultrices sagittis orci vitae sagittis. Sed sed mauris vehicula, ultrices leo a, dictum felis. Fusce convallis pulvinar sem eget lacinia. Proin sit amet nibh mi.', 'doctor' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (1, '1.7204153,41.226827', 'Carrer De Tarragona 5, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Vivamus at scelerisque est, ac facilisis eros. Nam mollis mi eu fermentum tempor. Duis massa elit, laoreet et mattis vel, auctor ac nibh. Duis a erat auctor, pretium sem gravida, tempus mi. Ut est erat, luctus sed nisi a, consectetur efficitur nunc. Duis ut nunc elementum, feugiat est eget, tincidunt velit. Suspendisse in dapibus justo. Sed imperdiet eu metus vitae hendrerit. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed sit amet sodales felis, vel viverra dui. Ut interdum quam felis, quis condimentum turpis tempor sollicitudin. Nam ac placerat massa. Nunc placerat sem ultrices neque dictum, sed bibendum libero scelerisque. Aliquam tincidunt orci elementum ipsum sagittis pretium. Praesent arcu felis, interdum vitae interdum quis, consequat eu tortor. ', 'doctor' );


INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.718035, 41.228000', 'Ronda Ibèrica 161, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec luctus sapien ac odio ornare pellentesque eget ut enim. Etiam commodo sem eget neque accumsan ullamcorper. Proin mattis sapien tellus, quis facilisis sem fermentum a. Nullam malesuada sem in neque eleifend consequat. Sed quis justo dictum, tristique felis non, porta tortor. Quisque volutpat interdum urna, id consectetur erat rutrum vel. Curabitur aliquet velit eget sapien porttitor cursus. Proin porta, lorem finibus cursus varius, sem velit convallis velit, aliquam laoreet ex nunc ac eros. Vestibulum ac libero sit amet libero tincidunt porttitor. In sed eleifend orci, eget feugiat est. Ut congue mauris magna, vitae accumsan neque suscipit quis. Maecenas ac ipsum arcu. Nunc enim ante, convallis quis erat nec, elementum porta nunc. ', 'fireman' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.7176908, 41.2179621','Carrer de Josep Coroleu, 52, 56, 08800 Vilanova i la Geltrú, Barcelona', 'Donec eget cursus nunc, sed posuere sapien. Praesent varius ac leo sed ullamcorper. Sed accumsan placerat augue, id accumsan nunc suscipit auctor. Quisque vitae leo libero. Vivamus mattis quis ante et ullamcorper. Sed tempor molestie feugiat. Pellentesque lobortis purus a consequat iaculis. Aenean mattis commodo diam id finibus. Curabitur pharetra libero lorem, at mollis felis pharetra accumsan. Phasellus sodales mi sed sagittis fermentum. In a massa orci. Donec eget magna id mauris laoreet fringilla vel in ligula. Nunc iaculis, lacus vitae efficitur tristique, mauris sapien vulputate orci, commodo volutpat nisl tortor eget nulla. ', 'fireman' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.7238606, 41.2214424','Rambla De Salvador Samà 49, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Donec eget cursus nunc, sed posuere sapien. Praesent varius ac leo sed ullamcorper. Sed accumsan placerat augue, id accumsan nunc suscipit auctor. Quisque vitae leo libero. Vivamus mattis quis ante et ullamcorper. Sed tempor molestie feugiat. Pellentesque lobortis purus a consequat iaculis. Aenean mattis commodo diam id finibus. Curabitur pharetra libero lorem, at mollis felis pharetra accumsan. Phasellus sodales mi sed sagittis fermentum. In a massa orci. Donec eget magna id mauris laoreet fringilla vel in ligula. Nunc iaculis, lacus vitae efficitur tristique, mauris sapien vulputate orci, commodo volutpat nisl tortor eget nulla. ', 'fireman' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (3, '1.7176781, 41.2170086','Carrer de Barcelona, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Donec eget cursus nunc, sed posuere sapien. Praesent varius ac leo sed ullamcorper. Sed accumsan placerat augue, id accumsan nunc suscipit auctor. Quisque vitae leo libero. Vivamus mattis quis ante et ullamcorper. Sed tempor molestie feugiat. Pellentesque lobortis purus a consequat iaculis. Aenean mattis commodo diam id finibus. Curabitur pharetra libero lorem, at mollis felis pharetra accumsan. Phasellus sodales mi sed sagittis fermentum. In a massa orci. Donec eget magna id mauris laoreet fringilla vel in ligula. Nunc iaculis, lacus vitae efficitur tristique, mauris sapien vulputate orci, commodo volutpat nisl tortor eget nulla. ', 'fireman' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (2, '1.7195577, 41.2186723', 'Rambla de la Exposició, 59, 08800 Vilanova i la Geltrú, Barcelona', 'Aenean quis fringilla elit. Sed sit amet lorem vitae orci accumsan mattis eget non massa. Nunc ipsum ligula, consectetur quis imperdiet ac, ullamcorper ac elit. Suspendisse sagittis ultrices tellus et tristique. Curabitur augue quam, iaculis at lorem id, laoreet sagittis elit. Phasellus consequat metus mauris, in faucibus lorem ornare non. Quisque elementum, justo a viverra vehicula, neque metus feugiat ante, at viverra nunc lacus ut odio. Nullam ultrices maximus porttitor. Aenean hendrerit orci id ultricies aliquet. ', 'fireman' );
INSERT INTO emergency (severity, coords, address,  description, permission) VALUES (2, '1.7240076, 41.22431', 'Carrer Del Recreo 5, 08800 Vilanova i la Geltrú, Barcelona, Spain', 'Aenean quis fringilla elit. Sed sit amet lorem vitae orci accumsan mattis eget non massa. Nunc ipsum ligula, consectetur quis imperdiet ac, ullamcorper ac elit. Suspendisse sagittis ultrices tellus et tristique. Curabitur augue quam, iaculis at lorem id, laoreet sagittis elit. Phasellus consequat metus mauris, in faucibus lorem ornare non. Quisque elementum, justo a viverra vehicula, neque metus feugiat ante, at viverra nunc lacus ut odio. Nullam ultrices maximus porttitor. Aenean hendrerit orci id ultricies aliquet. ', 'fireman' );

--------------------------------

sudo -i -u postgres
psql
update devices set permission='doctor';
update users set rol='admin' where email='silvia@mail.com';
